<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">
<head>
  <title> events </title>
  <link rel="stylesheet" th:href="@{https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css}" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css">
  <link rel="stylesheet" type="text/css" th:href="@{/css/stylesheet.css}"/>
</head>
<body>
<main>
  <div class="settings">
    <div>
      <form th:action="@{/logout}" method="post">
        <button class="setting-button" type="submit">Log out</button>
      </form>
    </div>
    <div>
    <div> <a th:href="@{/addEventForm}">
      <button class="add-button"> + Add Event </button> </a> </div>
  </div>
  <div class ="header-event-board">
    <h1> Welcome to <b> [[${#request.userPrincipal.principal.fullName}]]</b>'s Event Board </h1>
  </div>
  <div class="classify-containter">
    <div class="type">
      <a th:href="@{/showEvents(tag='my')}">
        <button class="button-event-type">MyEvents</button>
      </a>
      <a th:href="@{/showEvents}">
      <button class="button-event-type">All Events</button></a>
      <a th:href="@{/showEvents(tag='past')}">
        <button class="button-event-type">Past Events</button>
      </a>
      <a th:href="@{/showEvents(tag='upcoming')}">
      <button class="button-event-type">Upcoming Events</button>
      </a>
    </div>
    <div class ="event-board">
      <div class="event-container" th:each="event : ${events}">
        <div class="image-container">
          <img th:if="${event.photosImagePath != null}"
               th:src="@{${event.photosImagePath}}"
               width="100%" height="160" />
          <img th:unless="${event.photosImagePath != null}"
               src="../static/images/event.jpg"
               width="100%" height="160"
               th:src="@{images/event.jpg}" />
        </div>
        <div class="content-container">
          <p class="event-name"> <a th:href="@{/eventPost(eventId=${event.id})}"> <b th:text="${event.eventName}"></b></a></p>
          <div class="seperator"> </div>
          <p class="event-date">
            <i class="far fa-calendar-alt"></i>
            <span th:text="${#dates.format(event.dateEvent, 'dd-MM-yyyy')} + ' at ' + ${event.timeEvent}"></span>
          </p>
          <div class="seperator"> </div>
          <p class="event-location">
            <i class="fas fa-map-marker-alt"></i>
            <span th:text="${event.location}"></span>
          </p>
          <div class="seperator"> </div>
          <div class="tags">
            <div class="category"> </div>
          </div>
          <div class="additional-info">
            <div class="description-wrapper"> <p th:text="${event.description}"></p> </div>
          </div>
          <div class="post-container" >
            <a th:href="@{/deleteEvent(eventId=${event.id})}">
              <button class="post-button" id="delete-button" sec:authorize="hasAuthority('ADMIN')">Delete 0</button>
            </a>
            <button class="rsvp-button" id="rsvp-button" sec:authorize="hasAuthority('USER')"
                    th:attr="data-event-id=${event.id}, data-rsvped=${event.attendees.contains(#authentication.principal)}">
              RSVP
            </button>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
            <script src="/js/rsvp.js"></script>

            <a th:href="@{/showUpdateEvent(eventId=${event.id})}">
              <button class="post-button" id="edit-button" sec:authorize="hasAuthority('ADMIN')"> Update </button></a>
          </div>
        </div>
      </div>
    </div>
  </div>
  </div>
</main>
</body>

</html>
